export interface City {
    name: string;
    timezone: string;
}

export const majorCities: City[] = [
    { name: 'Abu Dhabi, UAE', timezone: 'Asia/Dubai' },
    { name: 'Accra, Ghana', timezone: 'Africa/Accra' },
    { name: 'Addis Ababa, Ethiopia', timezone: 'Africa/Addis_Ababa' },
    { name: 'Adelaide, Australia', timezone: 'Australia/Adelaide' },
    { name: 'Ahmedabad, India', timezone: 'Asia/Kolkata' },
    { name: 'Algiers, Algeria', timezone: 'Africa/Algiers' },
    { name: 'Almaty, Kazakhstan', timezone: 'Asia/Almaty' },
    { name: 'Amman, Jordan', timezone: 'Asia/Amman' },
    { name: 'Amsterdam, Netherlands', timezone: 'Europe/Amsterdam' },
    { name: 'Anchorage, USA', timezone: 'America/Anchorage' },
    { name: 'Ankara, Turkey', timezone: 'Europe/Istanbul' },
    { name: 'Antananarivo, Madagascar', timezone: 'Africa/Antananarivo' },
    { name: 'Asuncion, Paraguay', timezone: 'America/Asuncion' },
    { name: 'Athens, Greece', timezone: 'Europe/Athens' },
    { name: 'Atlanta, USA', timezone: 'America/New_York' },
    { name: 'Auckland, New Zealand', timezone: 'Pacific/Auckland' },
    { name: 'Austin, USA', timezone: 'America/Chicago' },
    { name: 'Baghdad, Iraq', timezone: 'Asia/Baghdad' },
    { name: 'Baku, Azerbaijan', timezone: 'Asia/Baku' },
    { name: 'Bali, Indonesia', timezone: 'Asia/Makassar' },
    { name: 'Bangalore, India', timezone: 'Asia/Kolkata' },
    { name: 'Bangkok, Thailand', timezone: 'Asia/Bangkok' },
    { name: 'Barcelona, Spain', timezone: 'Europe/Madrid' },
    { name: 'Beijing, China', timezone: 'Asia/Shanghai' },
    { name: 'Beirut, Lebanon', timezone: 'Asia/Beirut' },
    { name: 'Belfast, UK', timezone: 'Europe/London' },
    { name: 'Belgrade, Serbia', timezone: 'Europe/Belgrade' },
    { name: 'Bergen, Norway', timezone: 'Europe/Oslo' },
    { name: 'Berlin, Germany', timezone: 'Europe/Berlin' },
    { name: 'Birmingham, UK', timezone: 'Europe/London' },
    { name: 'Bogotá, Colombia', timezone: 'America/Bogota' },
    { name: 'Boston, USA', timezone: 'America/New_York' },
    { name: 'Bratislava, Slovakia', timezone: 'Europe/Bratislava' },
    { name: 'Brisbane, Australia', timezone: 'Australia/Brisbane' },
    { name: 'Brussels, Belgium', timezone: 'Europe/Brussels' },
    { name: 'Bucharest, Romania', timezone: 'Europe/Bucharest' },
    { name: 'Budapest, Hungary', timezone: 'Europe/Budapest' },
    { name: 'Buenos Aires, Argentina', timezone: 'America/Argentina/Buenos_Aires' },
    { name: 'Busan, South Korea', timezone: 'Asia/Seoul' },
    { name: 'Cairo, Egypt', timezone: 'Africa/Cairo' },
    { name: 'Calgary, Canada', timezone: 'America/Edmonton' },
    { name: 'Cape Town, South Africa', timezone: 'Africa/Johannesburg' },
    { name: 'Caracas, Venezuela', timezone: 'America/Caracas' },
    { name: 'Casablanca, Morocco', timezone: 'Africa/Casablanca' },
    { name: 'Cebu, Philippines', timezone: 'Asia/Manila' },
    { name: 'Charlotte, USA', timezone: 'America/New_York' },
    { name: 'Chengdu, China', timezone: 'Asia/Shanghai' },
    { name: 'Chennai, India', timezone: 'Asia/Kolkata' },
    { name: 'Chicago, USA', timezone: 'America/Chicago' },
    { name: 'Chisinau, Moldova', timezone: 'Europe/Chisinau' },
    { name: 'Chongqing, China', timezone: 'Asia/Shanghai' },
    { name: 'Christchurch, New Zealand', timezone: 'Pacific/Auckland' },
    { name: 'Cleveland, USA', timezone: 'America/New_York' },
    { name: 'Colombo, Sri Lanka', timezone: 'Asia/Colombo' },
    { name: 'Columbus, USA', timezone: 'America/New_York' },
    { name: 'Copenhagen, Denmark', timezone: 'Europe/Copenhagen' },
    { name: 'Dakar, Senegal', timezone: 'Africa/Dakar' },
    { name: 'Dallas, USA', timezone: 'America/Chicago' },
    { name: 'Damascus, Syria', timezone: 'Asia/Damascus' },
    { name: 'Dar es Salaam, Tanzania', timezone: 'Africa/Dar_es_Salaam' },
    { name: 'Delhi, India', timezone: 'Asia/Kolkata' },
    { name: 'Denver, USA', timezone: 'America/Denver' },
    { name: 'Detroit, USA', timezone: 'America/New_York' },
    { name: 'Dhaka, Bangladesh', timezone: 'Asia/Dhaka' },
    { name: 'Doha, Qatar', timezone: 'Asia/Qatar' },
    { name: 'Douala, Cameroon', timezone: 'Africa/Douala' },
    { name: 'Dubai, UAE', timezone: 'Asia/Dubai' },
    { name: 'Dublin, Ireland', timezone: 'Europe/Dublin' },
    { name: 'Durban, South Africa', timezone: 'Africa/Johannesburg' },
    { name: 'Edmonton, Canada', timezone: 'America/Edmonton' },
    { name: 'Faisalabad, Pakistan', timezone: 'Asia/Karachi' },
    { name: 'Frankfurt, Germany', timezone: 'Europe/Berlin' },
    { name: 'Gaborone, Botswana', timezone: 'Africa/Gaborone' },
    { name: 'Glasgow, UK', timezone: 'Europe/London' },
    { name: 'Gold Coast, Australia', timezone: 'Australia/Brisbane' },
    { name: 'Guadalajara, Mexico', timezone: 'America/Mexico_City' },
    { name: 'Guangzhou, China', timezone: 'Asia/Shanghai' },
    { name: 'Guatemala City, Guatemala', timezone: 'America/Guatemala' },
    { name: 'Gujranwala, Pakistan', timezone: 'Asia/Karachi' },
    { name: 'Halifax, Canada', timezone: 'America/Halifax' },
    { name: 'Hamburg, Germany', timezone: 'Europe/Berlin' },
    { name: 'Hanoi, Vietnam', timezone: 'Asia/Ho_Chi_Minh' },
    { name: 'Harare, Zimbabwe', timezone: 'Africa/Harare' },
    { name: 'Havana, Cuba', timezone: 'America/Havana' },
    { name: 'Helsinki, Finland', timezone: 'Europe/Helsinki' },
    { name: 'Ho Chi Minh City, Vietnam', timezone: 'Asia/Ho_Chi_Minh' },
    { name: 'Hong Kong, China', timezone: 'Asia/Hong_Kong' },
    { name: 'Honolulu, USA', timezone: 'Pacific/Honolulu' },
    { name: 'Houston, USA', timezone: 'America/Chicago' },
    { name: 'Hyderabad, India', timezone: 'Asia/Kolkata' },
    { name: 'Indianapolis, USA', timezone: 'America/Indiana/Indianapolis' },
    { name: 'Isfahan, Iran', timezone: 'Asia/Tehran' },
    { name: 'Islamabad, Pakistan', timezone: 'Asia/Karachi' },
    { name: 'Istanbul, Turkey', timezone: 'Europe/Istanbul' },
    { name: 'Jacksonville, USA', timezone: 'America/New_York' },
    { name: 'Jaipur, India', timezone: 'Asia/Kolkata' },
    { name: 'Jakarta, Indonesia', timezone: 'Asia/Jakarta' },
    { name: 'Jeddah, Saudi Arabia', timezone: 'Asia/Riyadh' },
    { name: 'Johannesburg, South Africa', timezone: 'Africa/Johannesburg' },
    { name: 'Kabul, Afghanistan', timezone: 'Asia/Kabul' },
    { name: 'Kampala, Uganda', timezone: 'Africa/Kampala' },
    { name: 'Kandy, Sri Lanka', timezone: 'Asia/Colombo' },
    { name: 'Kansas City, USA', timezone: 'America/Chicago' },
    { name: 'Karachi, Pakistan', timezone: 'Asia/Karachi' },
    { name: 'Kathmandu, Nepal', timezone: 'Asia/Kathmandu' },
    { name: 'Khartoum, Sudan', timezone: 'Africa/Khartoum' },
    { name: 'Kigali, Rwanda', timezone: 'Africa/Kigali' },
    { name: 'Kingston, Jamaica', timezone: 'America/Jamaica' },
    { name: 'Kolkata, India', timezone: 'Asia/Kolkata' },
    { name: 'Krakow, Poland', timezone: 'Europe/Warsaw' },
    { name: 'Kuala Lumpur, Malaysia', timezone: 'Asia/Kuala_Lumpur' },
    { name: 'Kuwait City, Kuwait', timezone: 'Asia/Kuwait' },
    { name: 'Kyiv, Ukraine', timezone: 'Europe/Kyiv' },
    { name: 'Kyoto, Japan', timezone: 'Asia/Tokyo' },
    { name: 'La Paz, Bolivia', timezone: 'America/La_Paz' },
    { name: 'Lagos, Nigeria', timezone: 'Africa/Lagos' },
    { name: 'Lahore, Pakistan', timezone: 'Asia/Karachi' },
    { name: 'Las Vegas, USA', timezone: 'America/Los_Angeles' },
    { name: 'Leon, France', timezone: 'Europe/Paris' },
    { name: 'Library, UK', timezone: 'Europe/London' },
    { name: 'Lima, Peru', timezone: 'America/Lima' },
    { name: 'Lisbon, Portugal', timezone: 'Europe/Lisbon' },
    { name: 'Ljubljana, Slovenia', timezone: 'Europe/Ljubljana' },
    { name: 'London, UK', timezone: 'Europe/London' },
    { name: 'Los Angeles, USA', timezone: 'America/Los_Angeles' },
    { name: 'Luanda, Angola', timezone: 'Africa/Luanda' },
    { name: 'Lucknow, India', timezone: 'Asia/Kolkata' },
    { name: 'Lusaka, Zambia', timezone: 'Africa/Lusaka' },
    { name: 'Luxembourg City, Luxembourg', timezone: 'Europe/Luxembourg' },
    { name: 'Madrid, Spain', timezone: 'Europe/Madrid' },
    { name: 'Malé, Maldives', timezone: 'Indian/Maldives' },
    { name: 'Manama, Bahrain', timezone: 'Asia/Bahrain' },
    { name: 'Manchester, UK', timezone: 'Europe/London' },
    { name: 'Manila, Philippines', timezone: 'Asia/Manila' },
    { name: 'Maputo, Mozambique', timezone: 'Africa/Maputo' },
    { name: 'Mecca, Saudi Arabia', timezone: 'Asia/Riyadh' },
    { name: 'Melbourne, Australia', timezone: 'Australia/Melbourne' },
    { name: 'Mexico City, Mexico', timezone: 'America/Mexico_City' },
    { name: 'Miami, USA', timezone: 'America/New_York' },
    { name: 'Milan, Italy', timezone: 'Europe/Rome' },
    { name: 'Minneapolis, USA', timezone: 'America/Chicago' },
    { name: 'Minsk, Belarus', timezone: 'Europe/Minsk' },
    { name: 'Mogadishu, Somalia', timezone: 'Africa/Mogadishu' },
    { name: 'Monterrey, Mexico', timezone: 'America/Monterrey' },
    { name: 'Montevideo, Uruguay', timezone: 'America/Montevideo' },
    { name: 'Montreal, Canada', timezone: 'America/Toronto' },
    { name: 'Moscow, Russia', timezone: 'Europe/Moscow' },
    { name: 'Multan, Pakistan', timezone: 'Asia/Karachi' },
    { name: 'Mumbai, India', timezone: 'Asia/Kolkata' },
    { name: 'Munich, Germany', timezone: 'Europe/Berlin' },
    { name: 'Muscat, Oman', timezone: 'Asia/Muscat' },
    { name: 'Nagoya, Japan', timezone: 'Asia/Tokyo' },
    { name: 'Nairobi, Kenya', timezone: 'Africa/Nairobi' },
    { name: 'Naples, Italy', timezone: 'Europe/Rome' },
    { name: 'Nashville, USA', timezone: 'America/Chicago' },
    { name: 'New York, USA', timezone: 'America/New_York' },
    { name: 'Nicosia, Cyprus', timezone: 'Asia/Nicosia' },
    { name: 'Orlando, USA', timezone: 'America/New_York' },
    { name: 'Osaka, Japan', timezone: 'Asia/Tokyo' },
    { name: 'Oslo, Norway', timezone: 'Europe/Oslo' },
    { name: 'Ottawa, Canada', timezone: 'America/Toronto' },
    { name: 'Panama City, Panama', timezone: 'America/Panama' },
    { name: 'Paris, France', timezone: 'Europe/Paris' },
    { name: 'Penang, Malaysia', timezone: 'Asia/Kuala_Lumpur' },
    { name: 'Perth, Australia', timezone: 'Australia/Perth' },
    { name: 'Peshawar, Pakistan', timezone: 'Asia/Karachi' },
    { name: 'Philadelphia, USA', timezone: 'America/New_York' },
    { name: 'Phnom Penh, Cambodia', timezone: 'Asia/Phnom_Penh' },
    { name: 'Phoenix, USA', timezone: 'America/Phoenix' },
    { name: 'Phuket, Thailand', timezone: 'Asia/Bangkok' },
    { name: 'Pittsburgh, USA', timezone: 'America/New_York' },
    { name: 'Podgorica, Montenegro', timezone: 'Europe/Podgorica' },
    { name: 'Portland, USA', timezone: 'America/Los_Angeles' },
    { name: 'Prague, Czech Republic', timezone: 'Europe/Prague' },
    { name: 'Pune, India', timezone: 'Asia/Kolkata' },
    { name: 'Pyongyang, North Korea', timezone: 'Asia/Pyongyang' },
    { name: 'Quebec City, Canada', timezone: 'America/Toronto' },
    { name: 'Quetta, Pakistan', timezone: 'Asia/Karachi' },
    { name: 'Quito, Ecuador', timezone: 'America/Quito' },
    { name: 'Rawalpindi, Pakistan', timezone: 'Asia/Karachi' },
    { name: 'Reykjavik, Iceland', timezone: 'Atlantic/Reykjavik' },
    { name: 'Riga, Latvia', timezone: 'Europe/Riga' },
    { name: 'Rio de Janeiro, Brazil', timezone: 'America/Sao_Paulo' },
    { name: 'Riyadh, Saudi Arabia', timezone: 'Asia/Riyadh' },
    { name: 'Rome, Italy', timezone: 'Europe/Rome' },
    { name: 'Rotterdam, Netherlands', timezone: 'Europe/Amsterdam' },
    { name: 'Saint Petersburg, Russia', timezone: 'Europe/Moscow' },
    { name: 'Salt Lake City, USA', timezone: 'America/Denver' },
    { name: 'San Antonio, USA', timezone: 'America/Chicago' },
    { name: 'San Diego, USA', timezone: 'America/Los_Angeles' },
    { name: 'San Francisco, USA', timezone: 'America/Los_Angeles' },
    { name: 'San Jose, Costa Rica', timezone: 'America/Costa_Rica' },
    { name: 'San Jose, USA', timezone: 'America/Los_Angeles' },
    { name: 'Sana\'a, Yemen', timezone: 'Asia/Sana' },
    { name: 'Santiago, Chile', timezone: 'America/Santiago' },
    { name: 'Santo Domingo, Dominican Republic', timezone: 'America/Santo_Domingo' },
    { name: 'São Paulo, Brazil', timezone: 'America/Sao_Paulo' },
    { name: 'Sarajevo, Bosnia & Herzegovina', timezone: 'Europe/Sarajevo' },
    { name: 'Seattle, USA', timezone: 'America/Los_Angeles' },
    { name: 'Seoul, South Korea', timezone: 'Asia/Seoul' },
    { name: 'Shanghai, China', timezone: 'Asia/Shanghai' },
    { name: 'Sharjah, UAE', timezone: 'Asia/Dubai' },
    { name: 'Shenzhen, China', timezone: 'Asia/Shanghai' },
    { name: 'Sialkot, Pakistan', timezone: 'Asia/Karachi' },
    { name: 'Singapore, Singapore', timezone: 'Asia/Singapore' },
    { name: 'Skopje, North Macedonia', timezone: 'Europe/Skopje' },
    { name: 'Sofia, Bulgaria', timezone: 'Europe/Sofia' },
    { name: 'Stockholm, Sweden', timezone: 'Europe/Stockholm' },
    { name: 'Sydney, Australia', timezone: 'Australia/Sydney' },
    { name: 'Taipei, Taiwan', timezone: 'Asia/Taipei' },
    { name: 'Tallinn, Estonia', timezone: 'Europe/Tallinn' },
    { name: 'Tampa, USA', timezone: 'America/New_York' },
    { name: 'Tashkent, Uzbekistan', timezone: 'Asia/Tashkent' },
    { name: 'Tbilisi, Georgia', timezone: 'Asia/Tbilisi' },
    { name: 'Tehran, Iran', timezone: 'Asia/Tehran' },
    { name: 'Tel Aviv, Israel', timezone: 'Asia/Jerusalem' },
    { name: 'Tirana, Albania', timezone: 'Europe/Tirane' },
    { name: 'Tokyo, Japan', timezone: 'Asia/Tokyo' },
    { name: 'Toronto, Canada', timezone: 'America/Toronto' },
    { name: 'Tripoli, Libya', timezone: 'Africa/Tripoli' },
    { name: 'Tunis, Tunisia', timezone: 'Africa/Tunis' },
    { name: 'Ulaanbaatar, Mongolia', timezone: 'Asia/Ulaanbaatar' },
    { name: 'Valencia, Spain', timezone: 'Europe/Madrid' },
    { name: 'Valletta, Malta', timezone: 'Europe/Malta' },
    { name: 'Vancouver, Canada', timezone: 'America/Vancouver' },
    { name: 'Vienna, Austria', timezone: 'Europe/Vienna' },
    { name: 'Vientiane, Laos', timezone: 'Asia/Vientiane' },
    { name: 'Vilnius, Lithuania', timezone: 'Europe/Vilnius' },
    { name: 'Warsaw, Poland', timezone: 'Europe/Warsaw' },
    { name: 'Washington, USA', timezone: 'America/New_York' },
    { name: 'Wellington, New Zealand', timezone: 'Pacific/Auckland' },
    { name: 'Winnipeg, Canada', timezone: 'America/Winnipeg' },
    { name: 'Wuhan, China', timezone: 'Asia/Shanghai' },
    { name: 'Yangon, Myanmar', timezone: 'Asia/Yangon' },
    { name: 'Yerevan, Armenia', timezone: 'Asia/Yerevan' },
    { name: 'Zagreb, Croatia', timezone: 'Europe/Zagreb' },
    { name: 'Zurich, Switzerland', timezone: 'Europe/Zurich' },
];

export interface TimezoneDiff {
    city1Name: string;
    city2Name: string;
    time1: string;
    time2: string;
    diffHours: string;
    workingOverlap: string;
}

export const calculateTimezoneDiff = (city1: City, city2: City): TimezoneDiff => {
    const now = new Date();

    const time1Str = now.toLocaleTimeString('en-US', { timeZone: city1.timezone, hour: '2-digit', minute: '2-digit' });
    const time2Str = now.toLocaleTimeString('en-US', { timeZone: city2.timezone, hour: '2-digit', minute: '2-digit' });

    // Calculate offset in hours
    const formatter1 = new Intl.DateTimeFormat('en-US', { timeZone: city1.timezone, timeZoneName: 'shortOffset' });
    const formatter2 = new Intl.DateTimeFormat('en-US', { timeZone: city2.timezone, timeZoneName: 'shortOffset' });

    const parts1 = formatter1.formatToParts(now);
    const parts2 = formatter2.formatToParts(now);

    const offset1Str = parts1.find(p => p.type === 'timeZoneName')?.value || 'GMT+0';
    const offset2Str = parts2.find(p => p.type === 'timeZoneName')?.value || 'GMT+0';

    const getOffsetNum = (str: string) => {
        if (str === 'GMT' || str === 'UTC') return 0;
        const match = str.match(/([+-])(\d+)(?::(\d+))?/);
        if (!match) return 0;
        const hours = parseInt(match[2]);
        const minutes = match[3] ? parseInt(match[3]) : 0;
        const val = hours + minutes / 60;
        return match[1] === '-' ? -val : val;
    };

    const off1 = getOffsetNum(offset1Str);
    const off2 = getOffsetNum(offset2Str);
    const diff = off2 - off1;

    const diffStr = diff === 0 ? 'No difference' : `${Math.abs(diff)} hours ${diff > 0 ? 'ahead' : 'behind'}`;

    // Overlap (Standard 9 AM - 5 PM)
    const workingStart = 9;
    const workingEnd = 17;

    let overlapHours = 0;
    for (let h = 0; h < 24; h++) {
        const city1Hour = h;
        const city2Hour = (h + diff + 24) % 24;

        if (city1Hour >= workingStart && city1Hour < workingEnd && city2Hour >= workingStart && city2Hour < workingEnd) {
            overlapHours++;
        }
    }

    const overlapStr = overlapHours === 0 ? 'No typical working hour overlap' : `${overlapHours} hours of (9-5) overlap`;

    return {
        city1Name: city1.name,
        city2Name: city2.name,
        time1: time1Str,
        time2: time2Str,
        diffHours: diffStr,
        workingOverlap: overlapStr
    };
};
